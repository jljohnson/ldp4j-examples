<html>
    <head>
        <title>LDP4j examples</title>
        <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=java&skin=sunburst"></script>
    </head>
    <body onload="prettyPrint()">
        <h1>Building read-write Linked Data applications with LDP4j</h1>
        <p>This project contains two simple LDP4j applications that demonstrate the basics of building read-write Linked Data applications using LDP4j.</p>
        <ul>
            <li>
                <h3>FOAF Profiles App that shows</h3> 
                <ul>
                    <li>how to publish domain entities as Linked Data resources using LDP4j</li>
                    <li>how to make those resources modifiable</li>
                </ul>
            </li>
            <li>
                <h3>Contact List App that shows</h3>
                <ul>
                    <li>how to create new resources and the usage of three different kinds of LDP containers</li>
                    <li>how to make resources deletable</li>
                </ul>
            </li>
        </ul>
        <p>The applications implement the examples from the slides <a href="http://www.slideshare.net/nandana/learning-w3c-linked-data-platform-with-examples">Learning W3C Linked Data Platform 1.0</a>.</p>
        
        <h3>FOAF Profiles App</h3>
        <p>The goal of this application is to expose data about a set of people as FOAF profiles. These FOAF profiles should be both readable and writable.</p>
        
        <h2>Development</h2>
        <p> These are the main steps:</p>
        <ul>
            <li>Implementing a resource handler to handle LDP requests. This provides the GET, OPTIONS, and HEAD functionalities.
            
            <pre class="prettyprint lang-java">
@Resource(id = FOAFProfileHandler.ID)
public class FOAFProfileHandler implements ResourceHandler {

	public static final String ID = "FOAFProfileHandler";

	public DataSet get(ResourceSnapshot resource) {
        // Resource retrival logic
	}
}
</pre>
            </li>
            <li> Making the resources modifiable by implementing the Modifiable interface
             <pre class="prettyprint lang-java">
@Resource(id = FOAFProfileHandler.ID)
public class FOAFProfileHandler implements ResourceHandler, Modifiable {

	public static final String ID = "FOAFProfileHandler";

	public DataSet get(ResourceSnapshot resource) {
        // Resource retrival logic goes here
	}
    
    public void update(ResourceSnapshot resource, DataSet content, WriteSession session)
			throws ContentProcessingException {
        // Resource modification logic goes here
    }
}
</pre>           
            </li>
            <li> Implementing the Application class and doing the initialization 
            <pre class="prettyprint lang-java">   
public class FOAFProfileApplication extends Application<Configuration> {

	@Override
	public void setup(Environment environment, Bootstrap<Configuration> bootstrap) {

		bootstrap.addHandler(new FOAFProfileHandler());

		//publishing initial resources
		for (Person p : DummyDataStore.getPersonlist()) {
			environment.publishResource(NamingScheme.getDefault().name(p.getId()), FOAFProfileHandler.class,
					String.format("%s/", p.getId()));
		}

	}

	@Override
	public void initialize(WriteSession session) {
		// any initialization logic

	}

	@Override
	public void shutdown() {
		// any shutdown logic
	}

}
</pre>                 
            </li>
        <li> Add the 'ldp4jTargetApplication' context parameter to web.xml
             <pre class="prettyprint lang-xml">   
&lt;web-app
	metadata-complete=&quot;false&quot;
	version=&quot;3.0&quot;
	xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xsi:schemaLocation=&quot;
		http://java.sun.com/xml/ns/javaee 
		http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;&gt;

	&lt;display-name&gt;FOAF Profiles LDP4j Application&lt;/display-name&gt;
	
	&lt;context-param&gt;
		&lt;param-name&gt;ldp4jTargetApplication&lt;/param-name&gt;
		&lt;param-value&gt;org.ldp4j.examples.foaf.app.FOAFProfileApplication&lt;/param-value&gt;
	&lt;/context-param&gt;

&lt;/web-app&gt;
</pre>        
        </li>    
        </ul>  
                
        <h2>Deployment</h2> 
        <p>The application can be built using maven and the resulting war file can be deployed in any servlet container.</p>
        <p> Alternatively, you can use the jetty maven plugin to deploy it. </p>
                
        <pre class="prettyprint">
 nandana@nandana-com:~/srcroot/github/ldp4j-examples/foaf$ mvn jetty:run
 
 
[INFO] --- jetty-maven-plugin:9.2.3.v20140905:run (default-cli) @ ldp4j-foaf ---
2014-11-08 02:04:09.617:INFO::main: Logging initialized @3578ms
[INFO] Configuring Jetty for project: LDP4j :: Examples :: FOAF Profiles App
[INFO] webAppSourceDirectory not set. Trying src/main/webapp
[INFO] Reload Mechanic: automatic
[INFO] Classes = /home/nandana/srcroot/github/ldp4j-examples/foaf/target/classes
[INFO] Context path = /
[INFO] Tmp directory = /home/nandana/srcroot/github/ldp4j-examples/foaf/target/tmp
[INFO] Web defaults = org/eclipse/jetty/webapp/webdefault.xml
[INFO] Web overrides =  none
[INFO] web.xml file = file:/home/nandana/srcroot/github/ldp4j-examples/foaf/src/main/webapp/WEB-INF/web.xml
[INFO] Webapp directory = /home/nandana/srcroot/github/ldp4j-examples/foaf/src/main/webapp
2014-11-08 02:04:09.713:INFO:oejs.Server:main: jetty-9.2.3.v20140905
0    [main] DEBUG org.ldp4j.server.setup.BootstrapContainerInitializer  - Starting container jetty/9.2.3.v20140905 3.0
1    [main] DEBUG org.ldp4j.server.setup.BootstrapContainerInitializer  - * Context started:
1    [main] DEBUG org.ldp4j.server.setup.BootstrapContainerInitializer  - - Name...........: FOAF Profiles LDP4j Application
1    [main] DEBUG org.ldp4j.server.setup.BootstrapContainerInitializer  - - Public path....: 
1    [main] DEBUG org.ldp4j.server.setup.BootstrapContainerInitializer  - - Deployment path: /home/nandana/srcroot/github/ldp4j-examples/foaf/src/main/webapp
1    [main] DEBUG org.ldp4j.server.setup.BootstrapContainerInitializer  - - Applications...: [class org.ldp4j.examples.foaf.app.FOAFProfileApplication, class org.ldp4j.example.MyApplication]
2014-11-08 02:04:11.993:INFO:/:main: Initializing Spring root WebApplicationContext
243  [main] INFO  org.springframework.web.context.ContextLoader  - Root WebApplicationContext: initialization started
269  [main] INFO  org.springframework.web.context.support.XmlWebApplicationContext  - Refreshing Root WebApplicationContext: startup date [Sat Nov 08 02:04:12 CET 2014]; root of context hierarchy
303  [main] INFO  org.springframework.beans.factory.xml.XmlBeanDefinitionReader  - Loading XML bean definitions from class path resource [beans.xml]
595  [main] INFO  org.springframework.beans.factory.xml.XmlBeanDefinitionReader  - Loading XML bean definitions from class path resource [META-INF/cxf/cxf.xml]
632  [main] INFO  org.springframework.beans.factory.xml.XmlBeanDefinitionReader  - Loading XML bean definitions from class path resource [META-INF/cxf/cxf-servlet.xml]
779  [main] INFO  org.springframework.beans.factory.support.DefaultListableBeanFactory  - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@275cd942: defining beans [cxf,org.apache.cxf.bus.spring.BusWiringBeanFactoryPostProcessor,org.apache.cxf.bus.spring.Jsr250BeanPostProcessor,org.apache.cxf.bus.spring.BusExtensionPostProcessor,logInInterceptor,logOutInterceptor,frontend,api]; root of factory hierarchy
849  [main] DEBUG org.ldp4j.application.engine.util.ListenerManager  - Registered 33A5D1EE (org.ldp4j.server.frontend.ServerFrontend$LocalApplicationEngineLifecycleListener)
1041 [main] INFO  org.apache.cxf.endpoint.ServerImpl  - Setting the server's publish address to be /ldp4j
1093 [main] INFO  org.springframework.web.context.ContextLoader  - Root WebApplicationContext: initialization completed in 850 ms
1105 [main] DEBUG org.ldp4j.server.frontend.ServerFrontend  - LDP4j Application Engine state changed to 'AVAILABLE'
1120 [main] DEBUG org.ldp4j.server.frontend.ServerFrontend  - LDP4j Application Engine state changed to 'STARTED'
1126 [main] DEBUG org.ldp4j.application.engine.util.ListenerManager  - Registered 2DA40C90 (org.ldp4j.application.DefaultApplicationContext$LocalEndpointLifecycleListener)
1171 [main] DEBUG org.ldp4j.application.lifecycle.EnvironmentImpl  - Published resource 'ResourceId{name=nandana, templateId=FOAFProfileHandler}' at 'nandana/'
1171 [main] DEBUG org.ldp4j.application.lifecycle.EnvironmentImpl  - Published resource 'ResourceId{name=raul, templateId=FOAFProfileHandler}' at 'raul/'
1171 [main] DEBUG org.ldp4j.application.lifecycle.EnvironmentImpl  - Published resource 'ResourceId{name=miguel, templateId=FOAFProfileHandler}' at 'miguel/'
1172 [main] DEBUG org.ldp4j.application.session.WriteSessionService  - Created write session: WriteSessionConfiguration{path=null, targetSnapshot=null}
1176 [main] INFO  org.ldp4j.examples.foaf.app.FOAFProfileApplication  - Initializing FOAF Profiles LDP4j application: org.ldp4j.application.session.DelegatedWriteSession@7cadd25d
1176 [main] DEBUG org.ldp4j.application.session.WriteSessionService  - Force termination of active session...
1176 [main] INFO  org.ldp4j.application.lifecycle.ApplicationLifecycleService  - Application 'FOAFProfileApplication' (org.ldp4j.examples.foaf.app.FOAFProfileApplication) initialized.
1177 [main] INFO  org.ldp4j.server.setup.BootstrapContextListener  - LDP4j Application 'FOAFProfileApplication' (org.ldp4j.examples.foaf.app.FOAFProfileApplication) initialized.
1177 [main] DEBUG org.ldp4j.server.setup.BootstrapContainerInitializer  - Context at '' initialized...
2014-11-08 02:04:12.962:INFO:oejsh.ContextHandler:main: Started o.e.j.m.p.JettyWebAppContext@50ddca7a{/,file:/home/nandana/srcroot/github/ldp4j-examples/foaf/src/main/webapp/,AVAILABLE}{file:/home/nandana/srcroot/github/ldp4j-examples/foaf/src/main/webapp/}
2014-11-08 02:04:12.963:WARN:oejsh.RequestLogHandler:main: !RequestLog
2014-11-08 02:04:12.983:INFO:oejs.ServerConnector:main: Started ServerConnector@13ec8be7{HTTP/1.1}{0.0.0.0:8080}
2014-11-08 02:04:12.983:INFO:oejs.Server:main: Started @6948ms
[INFO] Started Jetty Server
        </pre>                
    </body>
</html>